import{S as c,i as p,s as d}from"../../../chunks/index-374dfc94.js";import{x as l}from"../../../chunks/cookiesAndAuth-44faa8b3.js";function h(e){var o=new Headers;let i=JSON.stringify(e.jsonContent);o.append("Authorization","Token "+l("rtnt")),o.append("Content-Type","application/json");var s=JSON.stringify({nom_proj:e.nom_proj,color:e.color,jsonContent:i,priv:!0});return new Promise((r,a)=>{fetch("https://retinereq.jetevois.fr:8000/sondages/edit/",{method:"POST",headers:o,body:s,redirect:"follow"}).then(n=>n.text()).then(n=>{let t=JSON.parse(n).id;r(t)}).catch(n=>a(n))})}function m(e,o){var i=new Headers;let s=JSON.stringify(e.jsonContent);i.append("Authorization","Token "+l("rtnt")),i.append("Content-Type","application/json");var r=JSON.stringify({nom_proj:e.nom_proj,color:e.color,jsonContent:s,priv:!0});return new Promise((a,n)=>{fetch(`https://retinereq.jetevois.fr:8000/sondages/edit/${o}/`,{method:"PUT",headers:i,body:r,redirect:"follow"}).then(t=>t.text()).then(t=>{new Date().toLocaleString(),a("saved")}).catch(t=>{n(t)})})}const S=(e,o,i)=>{Swal.fire({title:"Publier le sondage ?",text:"Vous ne pourrez plus effectuer de modifications.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#2FCC72",cancelButtonColor:"grey",confirmButtonText:"Publier le sondage",cancelButtonText:"Annuler"}).then(s=>{if(s.isConfirmed){var r=new Headers;let n=JSON.stringify(e.jsonContent);r.append("Authorization","Token "+l("rtnt")),r.append("Content-Type","application/json");var a=JSON.stringify({nom_proj:e.nom_proj,color:e.color,jsonContent:n,priv:!1});return fetch(`https://retinereq.jetevois.fr:8000/sondages/edit/${o}/`,{method:"PUT",headers:r,body:a,redirect:"follow"}).then(t=>t.text()).then(t=>{console.log(t),Swal.fire("Le sondage est publi\xE9!","retine.io/sondage#"+o,"success")}).catch(t=>console.log("error",t))}})};class g extends c{constructor(o){super(),p(this,o,null,null,d,{})}}export{g as default,h as firstSave,m as updateSave,S as validateSondage};
