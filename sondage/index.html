<!doctype html>
<html lang="fr">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, , maximum-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/chatStyle.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lexend+Deca&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@500&display=swap" rel="stylesheet">
    <title>Sondage Rétine</title>
    <link rel="icon" href="/img/favicon.ico" id="light-scheme-favicon" />
    <link rel="icon" href="/img/faviconBlanc.ico" id="dark-scheme-favicon" />
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
</head>

<body style=" font-family: 'Raleway', sans-serif;height: 100vh;overflow: hidden;background-color: #FAF7FF;">
    <div class="container-fluid d-flex align-content-center flex-column h-100" style="height: -webkit-fill-available;">

        <div class="h-100 w-100 d-flex flex-column justify-content-between m-auto" style="max-width: 500px; background-color: #FAF7FF;">

            <!--Header-->
            <div class="w-100 d-flex align-items-center justify-content-between" style="background-color: transparent;">
                <div class="p-3" style="font-family: Lexend Deca; font-size: 1.2rem; font-weight: 600;"><img src="/img/favicon.ico"
                        style="height:30px;"> Rétine</div>
                <div id="pourcentageAdv">0%</div>
            </div>

            <div class="h-100 d-flex flex-column justify-content-between scrollbehavior" style="overflow-y: scroll; scroll-behavior: smooth;
            ">
                <!--Body-->
                <div style="background-color: transparent;">
                    <div id="messageFeed" class="h-100 p-2 d-flex  flex-column justify-content-start">
                    </div>
                </div>

                <!--Input Zone-->
                <div class="w-100">
                    <div id="inputZone" class="h-auto p-1 row w-100 m-auto" style="background-color: transparent; min-height: 100px;"></div>
                </div>

            </div>
        </div>

    </div>



    <script>
        window.onresize = function () {
            document.body.height = window.innerHeight;
        }
        window.onresize();
    </script>
    <script>
        var testChatParams;
        let scode = window.location.href.split("#")[1];
        var myHeaders = new Headers();
        myHeaders.append("Content-Type", "application/json");

        var requestOptions = {
            method: 'GET',
            headers: myHeaders,
            redirect: 'follow'
        };

        fetch("https://retinereq.jetevois.fr:8000/sondages/" + scode + "/", requestOptions)
            .then(response => response.text())
            .then(result => {
                testChatParams = JSON.parse(result);
                testChatParams['jsonContent'] = JSON.parse(testChatParams['jsonContent']);
                reiniTialisationChat(testChatParams);
            })
            .catch(error => {
                console.log('error', error);
                document.querySelector('#messageFeed').insertAdjacentHTML("beforeend", '<div class="p-4 endAnim"><lottie-player src="https://assets1.lottiefiles.com/packages/lf20_rmedmpzu.json" background="transparent"  speed="1"  style="width: 100%;" autoplay loop></lottie-player></div>');
            });
    </script>
    <script src="/script/chatScript.js"></script>
</body>

</html>